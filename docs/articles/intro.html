<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to {simaerep} • simaerep</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to {simaerep}">
<meta property="og:description" content="simaerep">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">simaerep</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/check_poisson.html">Checking the Applicability of a Poisson Test</a>
    </li>
    <li>
      <a href="../articles/intro.html">Introduction to {simaerep}</a>
    </li>
    <li>
      <a href="../articles/usability_limits.html">Address Usability Limits of the Bootstrap Method</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction to {simaerep}</h1>
            
      
      
      <div class="hidden name"><code>intro.Rmd</code></div>

    </div>

    
    
<div id="load" class="section level1">
<h1 class="hasAnchor">
<a href="#load" class="anchor"></a>Load</h1>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span>( <span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">tidyverse</span>) )
<span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span>( <span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">knitr</span>) )
<span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span>( <span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">simaerep</span>) )</pre></body></html></div>
</div>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>Simulate adverse event reporting in clinical trials with the goal of detecting under-reporting sites.</p>
<p>Monitoring of Adverse Event (AE) reporting in clinical trials is important for patient safety. We use bootstrap-based simulation to assign an AE under-reporting probability to each site in a clinical trial. The method is inspired by the ‘infer’ R package and Alen Downey’s blog article: <a href="http://allendowney.blogspot.com/2011/05/there-is-only-one-test.html">“There is only one test!”</a>.</p>
<div id="adverse-events" class="section level2">
<h2 class="hasAnchor">
<a href="#adverse-events" class="anchor"></a>Adverse Events</h2>
<p>An adverse event (AE) is any untoward medical occurrence in a patient or clinical investigation subject administered a pharmaceutical product and which does not necessarily have a causal relationship with this treatment. It is important for patient safety that AEs are reported back to the sponsor. An important part of quality monitoring is to detect clinical trial sites that are not propagating all of the AEs reported to them by their patients to the sponsor. In a clinical trial patients follow a strict visiting schedule at which times treatments are given and exams are being performed. Typically AEs get reported by a patient when they are at an on-site visit at the clinic. So the total number of AEs reported by a site depends on the number of patients enrolled at the site and the total number of visits.</p>
</div>
<div id="algorithm" class="section level2">
<h2 class="hasAnchor">
<a href="#algorithm" class="anchor"></a>Algorithm</h2>
<p>In a nutshell we will perform the following steps.</p>
<ol style="list-style-type: decimal">
<li>Record visit_med75, number of patients that have reached visit_med75, mean cumulative AE count at visit_med75 for a clinical trial site.</li>
<li>Create patient pool with all patients in study that have reached visit_med75 as determined in 1) and their cumulative AE count at visit_med75.</li>
<li>Draw with replacement as many patients from 2) as determined in 1) and calculate the mean cumulative AE count of the draw (figure 1b).</li>
<li>Repeat 3) 1000 times.</li>
<li>Calculate probability of obtaining mean cumulative AE count or lower as obtained in 1) based on results of 4).</li>
<li>Repeat 1-5) for all sites in trial</li>
<li>For a probability determined in 6) calculate expected false positive rate (FP) as probability * number of clinical trial sites.</li>
<li>For a probability determined in 5) calculate all positives (p) as the count of sites with the same probability or lower.</li>
<li>Calculate AE under-reporting probability for all sites as 1 - FP/p with results from 7-8)</li>
</ol>
</div>
<div id="sample-data" class="section level2">
<h2 class="hasAnchor">
<a href="#sample-data" class="anchor"></a>Sample Data</h2>
<div id="patient" class="section level3">
<h3 class="hasAnchor">
<a href="#patient" class="anchor"></a>Patient</h3>
<p>Patient level AE data is characterised by the number of consecutive visits and the number of AEs that have been reported each time. For the maximum consecutive visit we sample from a normal distribution and for the AEs reported at each visit we sample from a poisson distribution.</p>
<p>Here we simulate the AEs generated by 3 patients</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">1</span>)

<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span>(
   <span class="fl">3</span>,
   <span class="fu"><a href="../reference/boot_sim_test_data_patient.html">boot_sim_test_data_patient</a></span>(
    <span class="kw">.f_sample_max_visit</span> <span class="kw">=</span> <span class="kw">function</span>() <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="fl">1</span>, <span class="kw">mean</span> <span class="kw">=</span> <span class="fl">20</span>, <span class="kw">sd</span> <span class="kw">=</span> <span class="fl">4</span>),
    <span class="kw">.f_sample_ae_per_visit</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">max_visit</span>) <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span>(<span class="no">max_visit</span>, <span class="fl">0.5</span>)
  )
)</pre></body></html></div>
<pre><code>## [[1]]
##  [1]  0  1  1  2  4  5  6  6  6  6  7  7  8  8  9 12 12
## 
## [[2]]
##  [1] 0 1 1 1 1 1 1 2 2 2 2 2 2 3 4 5 5 6 6 7 8 9 9
## 
## [[3]]
##  [1] 0 0 1 2 2 3 3 3 3 3 3 3 4 4 6 6 6 6 7 7</code></pre>
</div>
<div id="study" class="section level3">
<h3 class="hasAnchor">
<a href="#study" class="anchor"></a>Study</h3>
<p>In order to simulate patient data for an entire study we assume make the simplification that all sites have the same number of patients. Further we specify a fraction of sites that is under-reporting AEs</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">df_visit</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/boot_sim_test_data_study.html">boot_sim_test_data_study</a></span>(
  <span class="kw">n_pat</span> <span class="kw">=</span> <span class="fl">120</span>,
  <span class="kw">n_sites</span> <span class="kw">=</span> <span class="fl">6</span>,
  <span class="kw">frac_site_with_ur</span> <span class="kw">=</span> <span class="fl">0.4</span>,
  <span class="kw">ur_rate</span> <span class="kw">=</span> <span class="fl">0.6</span>,
  <span class="kw">max_visit_mean</span> <span class="kw">=</span> <span class="fl">20</span>,
  <span class="kw">max_visit_sd</span> <span class="kw">=</span> <span class="fl">4</span>,
  <span class="kw">ae_per_visit_mean</span> <span class="kw">=</span> <span class="fl">0.5</span>
)

<span class="no">df_visit</span></pre></body></html></div>
<pre><code>## # A tibble: 2,336 x 8
##    patnum site_number is_ur max_visit_mean max_visit_sd ae_per_visit_me… visit
##    &lt;chr&gt;  &lt;chr&gt;       &lt;lgl&gt;          &lt;dbl&gt;        &lt;dbl&gt;            &lt;dbl&gt; &lt;int&gt;
##  1 P0000… S0001       TRUE              20            4              0.2     1
##  2 P0000… S0001       TRUE              20            4              0.2     2
##  3 P0000… S0001       TRUE              20            4              0.2     3
##  4 P0000… S0001       TRUE              20            4              0.2     4
##  5 P0000… S0001       TRUE              20            4              0.2     5
##  6 P0000… S0001       TRUE              20            4              0.2     6
##  7 P0000… S0001       TRUE              20            4              0.2     7
##  8 P0000… S0001       TRUE              20            4              0.2     8
##  9 P0000… S0001       TRUE              20            4              0.2     9
## 10 P0000… S0001       TRUE              20            4              0.2    10
## # … with 2,326 more rows, and 1 more variable: n_ae &lt;int&gt;</code></pre>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">df_visit</span> <span class="kw">%&gt;%</span>
  <span class="fu">select</span>(<span class="no">site_number</span>, <span class="no">is_ur</span>) <span class="kw">%&gt;%</span>
  <span class="fu">distinct</span>()</pre></body></html></div>
<pre><code>## # A tibble: 6 x 2
##   site_number is_ur
##   &lt;chr&gt;       &lt;lgl&gt;
## 1 S0001       TRUE 
## 2 S0002       TRUE 
## 3 S0003       FALSE
## 4 S0004       FALSE
## 5 S0005       FALSE
## 6 S0006       FALSE</code></pre>
<p>In our sample data 2 sites (S0001 and S0002) are under-reporting AEs</p>
</div>
</div>
<div id="specifying-the-evaluation-point-visit_med75" class="section level2">
<h2 class="hasAnchor">
<a href="#specifying-the-evaluation-point-visit_med75" class="anchor"></a>Specifying the Evaluation Point visit_med75</h2>
<p>In an ongoing trial all patients will have a different number of consecutive visits. To find a cut-off visit to normalize the data we specify a single evaluation point for a given site based on the number of visits of the patient population. We take the median of the maximum visit of all the patients and multiply by 0.75 (visit_med75). For this we use <code>site_aggr</code> to aggregate the simulated visit level data to site level.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">df_visit</span>$<span class="no">study_roche</span> <span class="kw">&lt;-</span> <span class="st">"A"</span>
<span class="no">df_site</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/site_aggr.html">site_aggr</a></span>(<span class="no">df_visit</span>)

<span class="no">df_site</span></pre></body></html></div>
<pre><code>## # A tibble: 6 x 6
## # Groups:   study_roche, site_number [6]
##   study_roche site_number n_patients visit_med75 n_pat_with_med75
##   &lt;chr&gt;       &lt;chr&gt;            &lt;int&gt;       &lt;dbl&gt;            &lt;dbl&gt;
## 1 A           S0001               20          15               17
## 2 A           S0002               20          14               17
## 3 A           S0003               20          16               16
## 4 A           S0004               20          14               17
## 5 A           S0005               20          15               18
## 6 A           S0006               20          15               20
## # … with 1 more variable: mean_ae_site_med75 &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fu"><a href="../reference/plot_visit_med75.html">plot_visit_med75</a></span>(<span class="no">df_visit</span>, <span class="no">df_site</span>, <span class="kw">study_roche_str</span> <span class="kw">=</span> <span class="st">"A"</span>, <span class="kw">n_site</span> <span class="kw">=</span> <span class="fl">6</span>)</pre></body></html></div>
<pre><code>## Warning: Removed 591 row(s) containing missing values (geom_path).</code></pre>
<p><img src="intro_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>Using the visit_med75 will drop a few patients (dashed lines) but will by definietion at least include 50% of all patients favouring patients that have higher number of visits. By looking at the mean ae development (purple line) we can already easily spot the two under-reporting sites. Same goes for looking at the <code>mean_ae_site_med75</code> column in <code>df_site</code>. Next we will use bootstrap simulations to determine the probability for obtaining each mean ae value or lower at visit_med75 by chance.</p>
</div>
<div id="bootstrap-simulations" class="section level2">
<h2 class="hasAnchor">
<a href="#bootstrap-simulations" class="anchor"></a>Bootstrap Simulations</h2>
<div id="advantage-over-classic-statistical-tests" class="section level3">
<h3 class="hasAnchor">
<a href="#advantage-over-classic-statistical-tests" class="anchor"></a>Advantage Over Classic Statistical Tests</h3>
<p>We could use a classical parametric test and calculate the probability with which we can reject the NULL hypothesis for the AE counts that we observe at the visit_med75.</p>
<p>As we sample from a poisson distribution an exact test about the ratio of the two rate parameters of the two samples with the AE count data would be appropriate.</p>
<p>But there are four major problems that we often encounter when we try to describe real life count data with the poisson distribution which is only described by a single parameter:</p>
<ul>
<li>over and underdispersion</li>
<li>skewness (long right tail)</li>
<li>inflated zeros</li>
<li>variance mean relationship might not be fixed</li>
</ul>
<p>(see <a href="https://www.gamlss.com/wp-content/uploads/2018/01/DistributionsForModellingLocationScaleandShape.pdf">Distiributuion for Modelling Location Scale and Shape 5.1.2</a>)</p>
<p>The true distribution of the AE counts will vary from study to study with the degree of the influence of these 4 problems being unknown unless thoroughly investigated.</p>
<p>With the non-parametric approach that we propose we do not need to worry about these statistical assumptions. Since the distribution of the AE count from the simulated patient pool we draw from will be very close to the unknown true distribution of the underlying AE generating process.</p>
</div>
<div id="disadvantages-over-classic-statistical-tests" class="section level3">
<h3 class="hasAnchor">
<a href="#disadvantages-over-classic-statistical-tests" class="anchor"></a>Disadvantages Over Classic Statistical Tests</h3>
<ul>
<li>The number of repeats determines the smallest probability greater than zero, for example a for r=1000 the smalles value greater than zero is 0.001</li>
<li>Computationally more expensive</li>
</ul>
</div>
<div id="methodology" class="section level3">
<h3 class="hasAnchor">
<a href="#methodology" class="anchor"></a>Methodology</h3>
<p><em>How likely is it to get a mean AE value that is equal or lower to what we observe at site C with the same number of patients?</em></p>
<p>For illustration purposes we start to simulate 10 hypothetical patient groups for site C by drawing (with replacement) from all patients in the study marking those for which we have obtained an equal or lower mean AE value than initially observed (middle).</p>
<p>Instead of 10 times we simulate 1000 times and count how many times we have observed an equal or lower mean AE value than initially observed and convert it to a percentage (right).</p>
<p>To illustrate the effect of under-reporting we repeat the same process after having removed 2 AEs per patient from site C. We see how the probability for obtaining an equal or lower mean AE value than initially observed decreases (bottom).</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="fu"><a href="../reference/plot_sim_examples.html">plot_sim_examples</a></span>(<span class="kw">size_dot</span> <span class="kw">=</span> <span class="fl">3</span>, <span class="kw">size_raster_label</span> <span class="kw">=</span> <span class="fl">10</span>)</pre></body></html></div>
<p><img src="intro_files/figure-html/unnamed-chunk-5-1.png" width="960"></p>
</div>
<div id="application" class="section level3">
<h3 class="hasAnchor">
<a href="#application" class="anchor"></a>Application</h3>
<p>We can run the above described simulation and as a becnhmark also perform a poisson test.</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="no">df_sim_sites</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/sim_sites.html">sim_sites</a></span>(<span class="no">df_site</span>, <span class="no">df_visit</span>, <span class="kw">r</span> <span class="kw">=</span> <span class="fl">1000</span>, <span class="kw">poisson_test</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="no">df_sim_sites</span></pre></body></html></div>
<pre><code>## # A tibble: 6 x 7
## # Groups:   study_roche, site_number [6]
##   study_roche site_number visit_med75 mean_ae_site_me… mean_ae_study_m…    pval
##   &lt;chr&gt;       &lt;chr&gt;             &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;   &lt;dbl&gt;
## 1 A           S0001                15             3                6.71 1.00e-9
## 2 A           S0002                14             3.35             6.02 7.46e-6
## 3 A           S0003                16             8.12             6.27 1.00e+0
## 4 A           S0004                14             7                5.35 1.00e+0
## 5 A           S0005                15             6.89             5.94 1.00e+0
## 6 A           S0006                15             7.85             5.69 1.00e+0
## # … with 1 more variable: prob_low &lt;dbl&gt;</code></pre>
<p>We find that the probability of getting a mean ae at visit_med75 for sites S0001 and S0002 is 0 or near zero.</p>
</div>
</div>
<div id="alpha-error-correction" class="section level2">
<h2 class="hasAnchor">
<a href="#alpha-error-correction" class="anchor"></a>Alpha Error Correction</h2>
<p>Our simulated test data set consists of just 6 sites. However, it is not uncommon for 100 sites or more to participate in the same clinical trial. This would mean that we neeed to perform 100 statistical tests, and applying a 5% significance threshold would lead to on average of 5 False Positives (FP). We therefore need to account for the number of expected FP when we are calculating the true under-reporting probability.</p>
<ul>
<li>For a given simulated probability calculate expected FP as probability * number of clinical trial sites.</li>
<li>For a given simulated probability calculate the number of positives (P) as the count of sites with the same probability or lower.</li>
<li>Calcutate the P/FP ratio</li>
<li>Express underreporting probability as 1 - FP/P</li>
</ul>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="no">df_eval</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/eval_sites.html">eval_sites</a></span>(<span class="no">df_sim_sites</span>,
                      <span class="kw">r_sim_sites</span> <span class="kw">=</span> <span class="fl">1000</span> <span class="co">#needs to be passed to in order to consider smallest value &gt; 0</span>
                      )
<span class="no">df_eval</span></pre></body></html></div>
<pre><code>## # A tibble: 6 x 16
## # Groups:   study_roche [1]
##   study_roche site_number visit_med75 mean_ae_site_me… mean_ae_study_m…     pval
##   &lt;chr&gt;       &lt;chr&gt;             &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;    &lt;dbl&gt;
## 1 A           S0001                15             3                6.71 4.87e-11
## 2 A           S0002                14             3.35             6.02 2.78e- 6
## 3 A           S0003                16             8.12             6.27 1.00e+ 0
## 4 A           S0004                14             7                5.35 1.00e+ 0
## 5 A           S0005                15             6.89             5.94 1.00e+ 0
## 6 A           S0006                15             7.85             5.69 1.00e+ 0
## # … with 10 more variables: prob_low &lt;dbl&gt;, n_site &lt;int&gt;,
## #   pval_n_detected &lt;int&gt;, pval_fp &lt;dbl&gt;, pval_p_vs_fp_ratio &lt;dbl&gt;,
## #   pval_prob_ur &lt;dbl&gt;, prob_low_n_detected &lt;int&gt;, prob_low_fp &lt;dbl&gt;,
## #   prob_low_p_vs_fp_ratio &lt;dbl&gt;, prob_low_prob_ur &lt;dbl&gt;</code></pre>
<p>the colummn <code>prob_low_p_vs_fp_ratio</code> contains the P/FP ratio. A ratio of 20 represents ~ 95 % probability of under-reporting (20/21) which we consider a sensible threshold.</p>
</div>
<div id="plot-results" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-results" class="anchor"></a>Plot Results</h2>
<p><code>plot_study</code> will plot mean ae development of all sites and visit level data for each flagged site using a P/FP threshold of 20</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="fu"><a href="../reference/plot_study.html">plot_study</a></span>(<span class="no">df_visit</span>, <span class="no">df_site</span>, <span class="no">df_eval</span>, <span class="kw">study</span> <span class="kw">=</span> <span class="st">"A"</span>)</pre></body></html></div>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_label).</code></pre>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_label).

## Warning: Removed 2 rows containing missing values (geom_label).</code></pre>
<p><img src="intro_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Bjoern Koneswarakantha.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
