<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Adjusted Evaluation Point visit_med75 â€¢ simaerep</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Adjusted Evaluation Point visit_med75">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-123997499-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123997499-2');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">simaerep</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.0.900</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fas fa-home fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../articles/intro.html">Get Started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/intro.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/inframe.html">Inframe Simulation Using Table Operations</a></li>
    <li><a class="dropdown-item" href="../articles/over.html">Over-Reporting Probability</a></li>
    <li><a class="dropdown-item" href="../articles/performance.html">Statistical Performance</a></li>
    <li><a class="dropdown-item" href="../articles/funnel_perf.html">Comparing {simaerep} and Funnel Plot Performance</a></li>
    <li><a class="dropdown-item" href="../articles/sas_files.html">SAS Files as a Data Source</a></li>
    <li><a class="dropdown-item" href="../articles/portfolio_perf.html">(superseeded) simaerep Portfolio Performance</a></li>
    <li><a class="dropdown-item" href="../articles/visit_med75.html">Adjusted Evaluation Point visit_med75</a></li>
    <li><a class="dropdown-item" href="../articles/usability_limits.html">Address Usability Limits of Bootstrap Method</a></li>
    <li><a class="dropdown-item" href="../articles/check_poisson.html">Check Poisson Test Applicability</a></li>
    <li><a class="dropdown-item" href="../articles/visits_or_days.html">Aggregate AEs by Days or Visit?</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/openpharma/simaerep/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Adjusted Evaluation Point visit_med75</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/openpharma/simaerep/blob/HEAD/vignettes/visit_med75.Rmd" class="external-link"><code>vignettes/visit_med75.Rmd</code></a></small>
      <div class="d-none name"><code>visit_med75.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="load">Load<a class="anchor" aria-label="anchor" href="#load"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://openpharma.github.io/simaerep/">simaerep</a></span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Previously we used an unadjusted visit_med75. Simply taking the
median of all maximum patient visits at a site and multiplying by 0.75.
If the number of patients at a site is reasonably large the smallest
maximum visit of the patients making the cut-off will be close or equal
to the cut-off point.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_visit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_test_data_study.html">sim_test_data_study</a></span><span class="op">(</span></span>
<span>  n_pat <span class="op">=</span> <span class="fl">120</span>,</span>
<span>  n_sites <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  frac_site_with_ur <span class="op">=</span> <span class="fl">0.4</span>,</span>
<span>  ur_rate <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_visit</span><span class="op">$</span><span class="va">study_id</span> <span class="op">&lt;-</span> <span class="st">"A"</span></span>
<span><span class="va">df_site</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/site_aggr.html">site_aggr</a></span><span class="op">(</span><span class="va">df_visit</span>, method <span class="op">=</span> <span class="st">"med75_adj"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_visit_med75.html">plot_visit_med75</a></span><span class="op">(</span><span class="va">df_visit</span>, <span class="va">df_site</span>, study_id_str <span class="op">=</span> <span class="st">"A"</span>, n_site <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## purple line:          mean site ae of patients with visit_med75</span></span>
<span><span class="co">## grey line:            patient included</span></span>
<span><span class="co">## black dashed line:    patient excluded</span></span>
<span><span class="co">## dotted vertical line: visit_med75, 0.75 x median of maximum patient visits of site </span></span>
<span><span class="co">## solid vertical line:  visit_med75 adjusted, increased to minimum maximum patient visit of included patients</span></span>
<span><span class="co">## dashed vertical line: maximum value for visit_med75 adjusted, 80% quantile of maximum patient visits of study</span></span></code></pre>
<p><img src="visit_med75_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="only-few-patients-per-site">Only few Patients per Site<a class="anchor" aria-label="anchor" href="#only-few-patients-per-site"></a>
</h2>
<p>If we only have a few patients per site chances will be greater that
the smallest maximum visit of those patients that make the cut-off is
much greater than the cut-off point and we could thus include more
visits into our analysis. For those cases we adjust the evaluation point
to the smallest maximum visit of all patients that make the initial
cut.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_visit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_test_data_study.html">sim_test_data_study</a></span><span class="op">(</span></span>
<span>  n_pat <span class="op">=</span> <span class="fl">24</span>,</span>
<span>  n_sites <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  frac_site_with_ur <span class="op">=</span> <span class="fl">0.4</span>,</span>
<span>  ur_rate <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_visit</span><span class="op">$</span><span class="va">study_id</span> <span class="op">&lt;-</span> <span class="st">"A"</span></span>
<span><span class="va">df_site</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/site_aggr.html">site_aggr</a></span><span class="op">(</span><span class="va">df_visit</span>, method <span class="op">=</span> <span class="st">"med75_adj"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_visit_med75.html">plot_visit_med75</a></span><span class="op">(</span><span class="va">df_visit</span>, <span class="va">df_site</span>, study_id_str <span class="op">=</span> <span class="st">"A"</span>, n_site <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## purple line:          mean site ae of patients with visit_med75</span></span>
<span><span class="co">## grey line:            patient included</span></span>
<span><span class="co">## black dashed line:    patient excluded</span></span>
<span><span class="co">## dotted vertical line: visit_med75, 0.75 x median of maximum patient visits of site </span></span>
<span><span class="co">## solid vertical line:  visit_med75 adjusted, increased to minimum maximum patient visit of included patients</span></span>
<span><span class="co">## dashed vertical line: maximum value for visit_med75 adjusted, 80% quantile of maximum patient visits of study</span></span></code></pre>
<p><img src="visit_med75_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="early-starters">Early Starters<a class="anchor" aria-label="anchor" href="#early-starters"></a>
</h2>
<p>It can happen that we have a site that has early starting patients.
To avoid an evaluation point for which we will only have a limited
patient pool we set a maximum limit for the evaluation point that
includes at least 20% of all patients in the study, by taking the 80%
quantile of all maximum patient visits at a study.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># early starting site</span></span>
<span><span class="va">df_visit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_test_data_study.html">sim_test_data_study</a></span><span class="op">(</span></span>
<span>  n_pat <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  n_sites <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  max_visit_sd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  max_visit_mean <span class="op">=</span> <span class="fl">40</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># late starting sites</span></span>
<span><span class="va">df_visit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_test_data_study.html">sim_test_data_study</a></span><span class="op">(</span></span>
<span>  n_pat <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  n_sites <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  max_visit_sd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  max_visit_mean <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_visit1</span><span class="op">$</span><span class="va">site_number</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="va">df_visit1</span><span class="op">$</span><span class="va">site_number</span><span class="op">)</span></span>
<span><span class="va">df_visit2</span><span class="op">$</span><span class="va">site_number</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"B"</span>, <span class="va">df_visit2</span><span class="op">$</span><span class="va">site_number</span><span class="op">)</span></span>
<span><span class="va">df_visit1</span><span class="op">$</span><span class="va">patnum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="va">df_visit1</span><span class="op">$</span><span class="va">patnum</span><span class="op">)</span></span>
<span><span class="va">df_visit2</span><span class="op">$</span><span class="va">patnum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"B"</span>, <span class="va">df_visit2</span><span class="op">$</span><span class="va">patnum</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">df_visit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">df_visit1</span>, <span class="va">df_visit2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_visit</span><span class="op">$</span><span class="va">study_id</span> <span class="op">&lt;-</span> <span class="st">"A"</span></span>
<span></span>
<span><span class="va">df_site</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/site_aggr.html">site_aggr</a></span><span class="op">(</span><span class="va">df_visit</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_visit_med75.html">plot_visit_med75</a></span><span class="op">(</span><span class="va">df_visit</span>, <span class="va">df_site</span>, study_id_str <span class="op">=</span> <span class="st">"A"</span>, n_site <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## purple line:          mean site ae of patients with visit_med75</span></span>
<span><span class="co">## grey line:            patient included</span></span>
<span><span class="co">## black dashed line:    patient excluded</span></span>
<span><span class="co">## dotted vertical line: visit_med75, 0.75 x median of maximum patient visits of site </span></span>
<span><span class="co">## solid vertical line:  visit_med75 adjusted, increased to minimum maximum patient visit of included patients</span></span>
<span><span class="co">## dashed vertical line: maximum value for visit_med75 adjusted, 80% quantile of maximum patient visits of study</span></span></code></pre>
<p><img src="visit_med75_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bjoern Koneswarakantha.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
